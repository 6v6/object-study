# 15장 디자인 패턴과 프레임워크
애플리케이션을 설계하다 보면 어떤 요구사항을 해결하기 위해  
과거에 경험했던 유사한 해결방법을 다시금 사용하는 경우가 있다.  
소프트웨어 설계에서 반복적으로 발생하는 문제에 대해  
반복적으로 적용할 수 있는 해결방법을 **디자인 패턴** 이라고 부른다.  

디자인 패턴의 목적은 설계를 재사용하는 것이다.  
디자인 패턴은 특정한 변경을 일관성 있게 다룰 수 있는 협력 템플릿을 제공한다.  
설계와 코드를 함께 재사용하기 위한 것을 프레임워크라고 부른다.

### 01. 디자인 패턴과 설계 재사용

**소프트웨어 패턴**

패턴의 특징

- 패턴은 반복적으로 발생하는 문제와 해법의 쌍으로 정의된다.
- 패턴을 사용함으로써 이미 알려진 문제와 이에 대한 해법을 문서로 정리할 수 있으며, 이 지식을 다른 사람과 의사소통할 수 있다.
- 패턴은 추상적인 원칙과 실제 코드 작성 사이의 간극을 메워주며 실질적인 코드 작성을 돕는다.
- 패턴의 요점은 패턴이 실무에서 탄생했다는 점이다.

패턴은 한 컨텍스트에서 유용함과 동시에 다른 컨텍스트에서도 유용한 아이디어이다.

패턴의 장점은 경험을 통해 축적된 실무 지식을 효과적으로 요약하고 전달할 수 있다는 점이다.

**패턴 분류**

- 디자인 패턴(Design Pattern)
  - 특정 상황 내에서 일반적인 설계 문제를 해결하며 협력하는 컴포넌트들 사이에서 반복적으로 발생하는 구조를 서술한다.
  - 특정한 설계문제를 해결하는 것이 목적이다.
  - 프로그래밍 언어나 패러다임에 독립적이다.
- 아키텍처 패턴 (Architecture Pattern)
  - 소프트웨어의 전체적인 구조를 결정하기 위해 사용한다.
  - 미리 정의된 서브시스템들을 제공하고 서브시스템들의 책임, 관계를 조직화하는 규칙과 가이드를 제공한다.
- 분석 패턴(Analysis Pattern)
  - 도메인 내의 개념적인 문제를 해결하는 데 초점을 맞춘다.
  - 업무 모델링 시에 발견되는 공통적인 구조를 표현하는 개념들의 집합이다..
- 이디엄(Idiom)
  - 특정 프로그래밍 언어에만 국한된 패턴이다.
  - 주어진 언어의 기능/특성을 이용해 컴포넌트 간의 특정 측면을 구현하는 방법을 서술한다.

**자주 쓰이는 디자인 패턴**

- COMPOSITE PATTERN  
  <img src="https://blog.kakaocdn.net/dn/dZXSLR/btq8IfCOqar/3LqYW8o1oZqBD7JdCHswDK/img.png" width="700"><br>
- STRATEGY PATTERN  
  <img src="https://blog.kakaocdn.net/dn/biy38k/btq8NdDrBSP/DZe6MkpjDId0zrzX2FMq1K/img.png" width="700"><br>
- TEMPLATE METHOD  
  <img src="https://k.kakaocdn.net/dn/bhQt8s/btq2fdZjd1G/Xrb7e9dKUKy7J4PR6OiKh1/img.jpg" width="700"><br>
- DECORATOR PATTERN  
  <img src="https://k.kakaocdn.net/dn/BQvXH/btq2gRVvXMV/oIWXPzw7sq5onbcKinu7Lk/img.jpg" width="700"><br>

패턴은 공통적인 문제에 적절한 해법을 제공하지만 우리가 직면한 문제에 적합하지 않을 수 있다.

하지만 패턴을 참조하여 현재 문제에 적절히 수정하여 해결 할 수 있어 알고 있으면 큰 도움이 된다.

### 02. 프레임워크와 코드 재사용
가장 이상적인 형태의 재사용 방법은 설계 재사용과 코드 재사용을 적절한 수준으로 조합하는 것이다.  
프레임워크가 코드를 재사용함으로써 설계 아이디어를 재사용한다.  
프레임워크는 애플리케이션의 아키텍처를 제공하며 문제 해결에 필요한 설계 결정과 이에 필요한 기반 코드를 함께 포함한다.  
애플리케이션을 확장할 수 있도록 부분적으로 구현된 추상 클래스와 인터페이스 집합뿐만 아니라  
추가적인 작업 없이도 재사용 가능한 다양한 종류의 컴포넌트도 함께 제공한다.  

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fk.kakaocdn.net%2Fdn%2FJDDGR%2Fbtq8GbHJSGB%2FaC4RpTRg0QpizjI8V6kN4k%2Fimg.png" width="700"><br>

**상위 정책과 하위 정책으로 패키지 분리하기**  
프레임워크의 핵심은 추상클래스나 인터페이스와 같은 추상화라고 할 수 있다.  
중요한 것은 패키지 사이의 의존성 방향이다.  
의존성 역전 원리에 따라 추상화에만 의존하도록 의존성의 방향을 조정하고 추상화를 경계로 분리 했기 때문에    
세부 사항을 구현한 패키지는 항상 상위 정책을 구현한 패키지에 의존해야 한다.  

상위 정책을 구현하고 있는 패키지가 충분히 안정적이면  
하위 정책 패키지로부터 완벽히 분리해서 별도의 배포 단위로 만들 수 있다.  
그럼 상위 정책 패키지는 여러 애플리케이션에서 재사용할 수 있게 된다.

**제어 역전 원리**  
의존성 역전 원리에 따라 구축되지 않은 시스템은 협력 흐름을 재사용할 수도 없으며 변경에 유연하게 대처할 수도 없다.  
시스템이 진화하는 방향에는 항상 의존성 역전 원리를 따르는 설계가 존재해야 한다.  
만약 요구사항이 빠르게 진화하는 코드에서 의존성 역전 원리가 적절하게 지켜지지 않고 있다면   
그곳에는 변경을 적절하게 수용할 수 없는 하향식 코드만 남을 뿐이다.

프레임워크에서는 일반적인 해결책만 제공하고 애플리케이션에 따라 달라질 수 있는 특정한 동작은 비워둔다.  
그리고 이렇게 완성되지 않은 채로 남겨진 동작을 훅(Hook) 이라고 부른다.  
재정의된 훅은 제어 역전 원리에 따라 프레임워크가 원하는 시점에 호출 된다.  
우리는 프레임워크가 적절한 시점에 실행 할 것으로 예상되는 코드를 작성 할 뿐이다.  
제어가 우리에게서 프레임워크로 넘어갔다.  
이러한 제어의 역전이 프레임워크의 핵심 개념이자 코드의 재사용을 가능하게 하는 힘이다.  
